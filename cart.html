<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ hàng - Beauty Nail Salon</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-top">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu"><i class="fas fa-bars"></i></button>
                <div class="logo">
                    <a href="index.html" class="logo-link">
                        <img src="logo.jpg" alt="Beauty Nail Salon" class="logo-image">
                        <span class="logo-text">BEAUTY NAIL SALON</span>
                    </a>
                </div>
                <div class="header-icons">
                    <a href="cart.html" class="icon-btn" title="Giỏ hàng" id="cartIconBtn">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge" id="cartBadge"></span>
                    </a>
                    <button class="icon-btn" id="searchBtn" title="Tìm kiếm"><i class="fas fa-search"></i></button>
                    <button class="icon-btn" id="bookingBtn" title="Đặt lịch"><i class="fas fa-calendar-check"></i></button>
                    <button class="icon-btn" id="sellerBtn" title="Đăng nhập người bán"><i class="fas fa-user-tie"></i></button>
                </div>
            </div>
            <nav class="main-nav" id="mainNav">
                <a href="products.html">SẢN PHẨM</a>
                <a href="dich-vu.html">DỊCH VỤ</a>
                <a href="dat-lich.html">ĐẶT LỊCH</a>
            </nav>
        </div>
    </header>

    <main class="cart-main">
        <div class="container">
            <h1 class="page-title">Giỏ hàng của bạn</h1>
            <div class="cart-table-wrapper" id="cartWrapper">
                <table class="cart-table" id="cartTable">
                    <thead>
                        <tr>
                            <th>Sản phẩm</th>
                            <th>Đơn giá</th>
                            <th>Số lượng</th>
                            <th>Thành tiền</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="cartBody"></tbody>
                </table>
                <div class="cart-summary" id="cartSummary" style="display:none;">
                    <p>Tổng cộng: <span class="cart-total" id="cartTotal">0đ</span></p>
                    <a href="shipping.html" class="checkout-btn">Tiến hành đặt hàng</a>
                </div>
            </div>
            <div class="cart-empty" id="cartEmpty" style="display:none;">
                <p>Giỏ hàng trống. <a href="products.html">Xem sản phẩm</a></p>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p class="copyright">© 2025 Beauty Nail Salon</p>
            </div>
        </div>
    </footer>

    <div class="modal" id="sellerModal">
        <div class="modal-content seller-modal">
            <span class="close-btn" id="closeSellerModal">&times;</span>
            <h2>Đăng nhập Người Bán</h2>
            <div id="sellerFormWrapper">
                <form id="sellerLoginForm" class="seller-login-form">
                    <div class="form-group">
                        <label for="sellerEmail">Email *</label>
                        <input type="email" id="sellerEmail" required placeholder="seller@example.com">
                    </div>
                    <div class="form-group">
                        <label for="sellerPassword">Mật khẩu *</label>
                        <input type="password" id="sellerPassword" required placeholder="Nhập mật khẩu">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="booking-submit-btn">Đăng nhập</button>
                        <button type="button" class="booking-submit-btn" id="sellerCancelBtn">Hủy</button>
                    </div>
                    <p class="seller-note">Demo: seller@example.com / sellerpass</p>
                </form>
            </div>
            <div id="sellerPanel" style="display:none;">
                <p>Đăng nhập: <strong id="sellerNameDisplay"></strong></p>
                <div class="seller-panel-actions">
                    <a href="seller-dashboard.html" class="booking-submit-btn">Bảng Điều Khiển</a>
                    <button id="sellerLogoutBtn" class="booking-submit-btn">Đăng xuất</button>
                </div>
            </div>
        </div>
    </div>

    <script src="store.js"></script>
    <script src="script.js"></script>
    <script>
        function renderCart() {
            const cart = getCart();
            const tbody = document.getElementById('cartBody');
            const summary = document.getElementById('cartSummary');
            const empty = document.getElementById('cartEmpty');
            const table = document.getElementById('cartTable');

            if (cart.length === 0) {
                table.style.display = 'none';
                summary.style.display = 'none';
                empty.style.display = 'block';
                return;
            }

            table.style.display = 'table';
            summary.style.display = 'flex';
            empty.style.display = 'none';

            tbody.innerHTML = cart.map(item => `
                <tr data-id="${item.id}">
                    <td><img src="${item.image}" alt="${item.name}" class="cart-thumb"> ${item.name}</td>
                    <td>${formatPrice(item.price)}</td>
                    <td><input type="number" value="${item.qty}" min="1" class="cart-qty-input" data-id="${item.id}"></td>
                    <td class="item-total">${formatPrice(item.price * item.qty)}</td>
                    <td><button class="remove-cart-btn" data-id="${item.id}"><i class="fas fa-trash"></i></button></td>
                </tr>
            `).join('');

            document.getElementById('cartTotal').textContent = formatPrice(getCartTotal());

            tbody.querySelectorAll('.cart-qty-input').forEach(input => {
                input.addEventListener('change', function() {
                    const id = this.dataset.id;
                    const qty = parseInt(this.value) || 1;
                    updateCartQty(id, qty);
                    renderCart();
                });
            });

            tbody.querySelectorAll('.remove-cart-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    removeFromCart(this.dataset.id);
                    renderCart();
                });
            });
        }

        document.addEventListener('DOMContentLoaded', renderCart);
    </script>
</body>
</html>
